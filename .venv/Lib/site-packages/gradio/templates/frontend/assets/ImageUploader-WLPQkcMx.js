import"./IconButtonWrapper.svelte_svelte_type_style_lang-Dn324h3u.js";import"./MarkdownCode.svelte_svelte_type_style_lang-tNKN3dsp.js";import{B as dt}from"./BlockLabel-8WtM61r3.js";import{I as gt}from"./IconButton-DSs-aBrk.js";import{C as pt}from"./Clear-By3xiIwg.js";import{I as ht,F as bt}from"./FullscreenButton-CxfkWNWn.js";import{W as wt,a as vt,S as kt}from"./SelectSource-Ct98E5mr.js";import{I as yt}from"./IconButtonWrapper-jknaAjP6.js";import{g as It}from"./utils-Gtzs_Zla.js";import{D as st}from"./DropdownArrow-CFmkDyPW.js";import{S as zt}from"./Square-oAGqOwsh.js";import"./StreamingBar.svelte_svelte_type_style_lang-CDNxkBIr.js";import{f as Ct}from"./index-C7tmv3G_.js";import{S as Dt}from"./StreamingBar-BU9S4hA7.js";import{h as St}from"./index-C5d30bwq.js";import{a as qt}from"./Upload-Dko0hrPS.js";import"./DownloadLink.svelte_svelte_type_style_lang-C_5UIfol.js";import{I as Et}from"./Image-CnqB5dbD.js";const{SvelteComponent:Wt,append:Je,attr:L,detach:Bt,init:Mt,insert:Tt,noop:je,safe_not_equal:Rt,svg_element:Ne}=window.__gradio__svelte__internal;function $t(l){let e,t,n;return{c(){e=Ne("svg"),t=Ne("path"),n=Ne("circle"),L(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),L(n,"cx","12"),L(n,"cy","13"),L(n,"r","4"),L(e,"xmlns","http://www.w3.org/2000/svg"),L(e,"width","100%"),L(e,"height","100%"),L(e,"viewBox","0 0 24 24"),L(e,"fill","none"),L(e,"stroke","currentColor"),L(e,"stroke-width","1.5"),L(e,"stroke-linecap","round"),L(e,"stroke-linejoin","round"),L(e,"class","feather feather-camera")},m(i,o){Tt(i,e,o),Je(e,t),Je(e,n)},p:je,i:je,o:je,d(i){i&&Bt(e)}}}class jt extends Wt{constructor(e){super(),Mt(this,e,null,$t,Rt,{})}}const{SvelteComponent:Nt,append:Ut,attr:O,detach:Lt,init:Pt,insert:Ft,noop:Ue,safe_not_equal:At,svg_element:Ke}=window.__gradio__svelte__internal;function Ht(l){let e,t;return{c(){e=Ke("svg"),t=Ke("circle"),O(t,"cx","12"),O(t,"cy","12"),O(t,"r","10"),O(e,"xmlns","http://www.w3.org/2000/svg"),O(e,"width","100%"),O(e,"height","100%"),O(e,"viewBox","0 0 24 24"),O(e,"stroke-width","1.5"),O(e,"stroke-linecap","round"),O(e,"stroke-linejoin","round"),O(e,"class","feather feather-circle")},m(n,i){Ft(n,e,i),Ut(e,t)},p:Ue,i:Ue,o:Ue,d(n){n&&Lt(e)}}}class Ot extends Nt{constructor(e){super(),Pt(this,e,null,Ht,At,{})}}const{SvelteComponent:Vt,append:ve,attr:Le,create_component:Gt,destroy_component:Jt,detach:Kt,element:Pe,init:Qt,insert:Xt,listen:Yt,mount_component:Zt,noop:xt,safe_not_equal:en,set_style:tn,space:nn,text:ln,transition_in:rn,transition_out:on}=window.__gradio__svelte__internal,{createEventDispatcher:sn}=window.__gradio__svelte__internal;function an(l){let e,t,n,i,o,r="Click to Access Webcam",c,s,u,m;return i=new wt({}),{c(){e=Pe("button"),t=Pe("div"),n=Pe("span"),Gt(i.$$.fragment),o=nn(),c=ln(r),Le(n,"class","icon-wrap svelte-qbrfs"),Le(t,"class","wrap svelte-qbrfs"),Le(e,"class","svelte-qbrfs"),tn(e,"height","100%")},m(_,w){Xt(_,e,w),ve(e,t),ve(t,n),Zt(i,n,null),ve(t,o),ve(t,c),s=!0,u||(m=Yt(e,"click",l[1]),u=!0)},p:xt,i(_){s||(rn(i.$$.fragment,_),s=!0)},o(_){on(i.$$.fragment,_),s=!1},d(_){_&&Kt(e),Jt(i),u=!1,m()}}}function cn(l){const e=sn();return[e,()=>e("click")]}class un extends Vt{constructor(e){super(),Qt(this,e,cn,an,en,{})}}function _n(){return navigator.mediaDevices.enumerateDevices()}function fn(l,e){e.srcObject=l,e.muted=!0,e.play()}async function Qe(l,e,t,n){const i={video:n?{deviceId:{exact:n},...t?.video}:t?.video||{width:{ideal:1920},height:{ideal:1440}},audio:l&&(t?.audio??!0)};return navigator.mediaDevices.getUserMedia(i).then(o=>(fn(o,e),o))}function mn(l){return l.filter(t=>t.kind==="videoinput")}const{SvelteComponent:dn,action_destroyer:gn,add_render_callback:pn,append:D,attr:k,binding_callbacks:hn,check_outros:fe,create_component:Z,create_in_transition:bn,destroy_component:x,destroy_each:wn,detach:N,element:T,empty:Oe,ensure_array_like:Xe,flush:V,group_outros:me,init:vn,insert:U,listen:Ce,mount_component:ee,noop:Ve,run_all:kn,safe_not_equal:yn,set_data:be,set_input_value:Fe,set_style:at,space:K,src_url_equal:Ye,stop_propagation:In,text:we,toggle_class:re,transition_in:E,transition_out:M}=window.__gradio__svelte__internal,{createEventDispatcher:zn,onDestroy:Cn,onMount:Dn}=window.__gradio__svelte__internal;function Ze(l,e,t){const n=l.slice();return n[39]=e[t],n}function Sn(l){let e,t,n,i,o,r,c,s,u,m,_;const w=[Wn,En],y=[];function R(b,I){return b[2]==="video"||b[1]?0:1}n=R(l),i=y[n]=w[n](l);let g=!l[11]&&xe(l),h=l[13]&&l[8]&&et(l);return{c(){e=T("div"),t=T("button"),i.c(),r=K(),g&&g.c(),c=K(),h&&h.c(),s=Oe(),k(t,"aria-label",o=l[2]==="image"?"capture photo":"start recording"),k(t,"class","svelte-10cpz3p"),k(e,"class","button-wrap svelte-10cpz3p")},m(b,I){U(b,e,I),D(e,t),y[n].m(t,null),D(e,r),g&&g.m(e,null),U(b,c,I),h&&h.m(b,I),U(b,s,I),u=!0,m||(_=Ce(t,"click",l[28]),m=!0)},p(b,I){let P=n;n=R(b),n===P?y[n].p(b,I):(me(),M(y[P],1,1,()=>{y[P]=null}),fe(),i=y[n],i?i.p(b,I):(i=y[n]=w[n](b),i.c()),E(i,1),i.m(t,null)),(!u||I[0]&4&&o!==(o=b[2]==="image"?"capture photo":"start recording"))&&k(t,"aria-label",o),b[11]?g&&(me(),M(g,1,1,()=>{g=null}),fe()):g?(g.p(b,I),I[0]&2048&&E(g,1)):(g=xe(b),g.c(),E(g,1),g.m(e,null)),b[13]&&b[8]?h?(h.p(b,I),I[0]&8448&&E(h,1)):(h=et(b),h.c(),E(h,1),h.m(s.parentNode,s)):h&&(me(),M(h,1,1,()=>{h=null}),fe())},i(b){u||(E(i),E(g),E(h),u=!0)},o(b){M(i),M(g),M(h),u=!1},d(b){b&&(N(e),N(c),N(s)),y[n].d(),g&&g.d(),h&&h.d(b),m=!1,_()}}}function qn(l){let e,t,n,i;return t=new un({}),t.$on("click",l[27]),{c(){e=T("div"),Z(t.$$.fragment),k(e,"title","grant webcam access"),at(e,"height","100%")},m(o,r){U(o,e,r),ee(t,e,null),i=!0},p:Ve,i(o){i||(E(t.$$.fragment,o),o&&(n||pn(()=>{n=bn(e,Ct,{delay:100,duration:200}),n.start()})),i=!0)},o(o){M(t.$$.fragment,o),i=!1},d(o){o&&N(e),x(t)}}}function En(l){let e,t,n;return t=new jt({}),{c(){e=T("div"),Z(t.$$.fragment),k(e,"class","icon svelte-10cpz3p"),k(e,"title","capture photo")},m(i,o){U(i,e,o),ee(t,e,null),n=!0},p:Ve,i(i){n||(E(t.$$.fragment,i),n=!0)},o(i){M(t.$$.fragment,i),n=!1},d(i){i&&N(e),x(t)}}}function Wn(l){let e,t,n,i;const o=[Tn,Mn,Bn],r=[];function c(s,u){return s[1]&&s[10]==="waiting"?0:s[1]&&s[10]==="open"||!s[1]&&s[11]?1:2}return e=c(l),t=r[e]=o[e](l),{c(){t.c(),n=Oe()},m(s,u){r[e].m(s,u),U(s,n,u),i=!0},p(s,u){let m=e;e=c(s),e===m?r[e].p(s,u):(me(),M(r[m],1,1,()=>{r[m]=null}),fe(),t=r[e],t?t.p(s,u):(t=r[e]=o[e](s),t.c()),E(t,1),t.m(n.parentNode,n))},i(s){i||(E(t),i=!0)},o(s){M(t),i=!1},d(s){s&&N(n),r[e].d(s)}}}function Bn(l){let e,t,n,i,o=l[4]("audio.record")+"",r,c;return n=new Ot({}),{c(){e=T("div"),t=T("div"),Z(n.$$.fragment),i=K(),r=we(o),k(t,"class","icon color-primary svelte-10cpz3p"),k(t,"title","start recording"),k(e,"class","icon-with-text svelte-10cpz3p")},m(s,u){U(s,e,u),D(e,t),ee(n,t,null),D(e,i),D(e,r),c=!0},p(s,u){(!c||u[0]&16)&&o!==(o=s[4]("audio.record")+"")&&be(r,o)},i(s){c||(E(n.$$.fragment,s),c=!0)},o(s){M(n.$$.fragment,s),c=!1},d(s){s&&N(e),x(n)}}}function Mn(l){let e,t,n,i,o=l[4]("audio.stop")+"",r,c;return n=new zt({}),{c(){e=T("div"),t=T("div"),Z(n.$$.fragment),i=K(),r=we(o),k(t,"class","icon color-primary svelte-10cpz3p"),k(t,"title","stop recording"),k(e,"class","icon-with-text svelte-10cpz3p")},m(s,u){U(s,e,u),D(e,t),ee(n,t,null),D(e,i),D(e,r),c=!0},p(s,u){(!c||u[0]&16)&&o!==(o=s[4]("audio.stop")+"")&&be(r,o)},i(s){c||(E(n.$$.fragment,s),c=!0)},o(s){M(n.$$.fragment,s),c=!1},d(s){s&&N(e),x(n)}}}function Tn(l){let e,t,n,i,o=l[4]("audio.waiting")+"",r,c;return n=new vt({}),{c(){e=T("div"),t=T("div"),Z(n.$$.fragment),i=K(),r=we(o),k(t,"class","icon color-primary svelte-10cpz3p"),k(t,"title","spinner"),k(e,"class","icon-with-text svelte-10cpz3p"),at(e,"width","var(--size-24)")},m(s,u){U(s,e,u),D(e,t),ee(n,t,null),D(e,i),D(e,r),c=!0},p(s,u){(!c||u[0]&16)&&o!==(o=s[4]("audio.waiting")+"")&&be(r,o)},i(s){c||(E(n.$$.fragment,s),c=!0)},o(s){M(n.$$.fragment,s),c=!1},d(s){s&&N(e),x(n)}}}function xe(l){let e,t,n,i,o;return t=new st({}),{c(){e=T("button"),Z(t.$$.fragment),k(e,"class","icon svelte-10cpz3p"),k(e,"aria-label","select input source")},m(r,c){U(r,e,c),ee(t,e,null),n=!0,i||(o=Ce(e,"click",l[29]),i=!0)},p:Ve,i(r){n||(E(t.$$.fragment,r),n=!0)},o(r){M(t.$$.fragment,r),n=!1},d(r){r&&N(e),x(t),i=!1,o()}}}function et(l){let e,t,n,i,o,r,c;n=new st({});function s(_,w){return _[7].length===0?$n:Rn}let u=s(l),m=u(l);return{c(){e=T("select"),t=T("button"),Z(n.$$.fragment),i=K(),m.c(),k(t,"class","inset-icon svelte-10cpz3p"),k(e,"class","select-wrap svelte-10cpz3p"),k(e,"aria-label","select source")},m(_,w){U(_,e,w),D(e,t),ee(n,t,null),D(t,i),m.m(e,null),o=!0,r||(c=[Ce(t,"click",In(l[30])),gn(Ge.call(null,e,l[17])),Ce(e,"change",l[14])],r=!0)},p(_,w){u===(u=s(_))&&m?m.p(_,w):(m.d(1),m=u(_),m&&(m.c(),m.m(e,null)))},i(_){o||(E(n.$$.fragment,_),o=!0)},o(_){M(n.$$.fragment,_),o=!1},d(_){_&&N(e),x(n),m.d(),r=!1,kn(c)}}}function Rn(l){let e,t=Xe(l[7]),n=[];for(let i=0;i<t.length;i+=1)n[i]=tt(Ze(l,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=Oe()},m(i,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(i,o);U(i,e,o)},p(i,o){if(o[0]&384){t=Xe(i[7]);let r;for(r=0;r<t.length;r+=1){const c=Ze(i,t,r);n[r]?n[r].p(c,o):(n[r]=tt(c),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&N(e),wn(n,i)}}}function $n(l){let e,t=l[4]("common.no_devices")+"",n;return{c(){e=T("option"),n=we(t),e.__value="",Fe(e,e.__value),k(e,"class","svelte-10cpz3p")},m(i,o){U(i,e,o),D(e,n)},p(i,o){o[0]&16&&t!==(t=i[4]("common.no_devices")+"")&&be(n,t)},d(i){i&&N(e)}}}function tt(l){let e,t=l[39].label+"",n,i,o,r;return{c(){e=T("option"),n=we(t),i=K(),e.__value=o=l[39].deviceId,Fe(e,e.__value),e.selected=r=l[8].deviceId===l[39].deviceId,k(e,"class","svelte-10cpz3p")},m(c,s){U(c,e,s),D(e,n),D(e,i)},p(c,s){s[0]&128&&t!==(t=c[39].label+"")&&be(n,t),s[0]&128&&o!==(o=c[39].deviceId)&&(e.__value=o,Fe(e,e.__value)),s[0]&384&&r!==(r=c[8].deviceId===c[39].deviceId)&&(e.selected=r)},d(c){c&&N(e)}}}function jn(l){let e,t,n,i,o,r,c,s,u,m,_;t=new Dt({props:{time_limit:l[9]}});const w=[qn,Sn],y=[];function R(g,h){return g[12]?1:0}return u=R(l),m=y[u]=w[u](l),{c(){e=T("div"),Z(t.$$.fragment),n=K(),i=T("video"),o=K(),r=T("img"),s=K(),m.c(),k(i,"class","svelte-10cpz3p"),re(i,"flip",l[3]),re(i,"hide",!l[12]||l[12]&&!!l[0]),Ye(r.src,c=l[0]?.url)||k(r,"src",c),k(r,"class","svelte-10cpz3p"),re(r,"hide",!l[12]||l[12]&&!l[0]),k(e,"class","wrap svelte-10cpz3p")},m(g,h){U(g,e,h),ee(t,e,null),D(e,n),D(e,i),l[26](i),D(e,o),D(e,r),D(e,s),y[u].m(e,null),_=!0},p(g,h){const b={};h[0]&512&&(b.time_limit=g[9]),t.$set(b),(!_||h[0]&8)&&re(i,"flip",g[3]),(!_||h[0]&4097)&&re(i,"hide",!g[12]||g[12]&&!!g[0]),(!_||h[0]&1&&!Ye(r.src,c=g[0]?.url))&&k(r,"src",c),(!_||h[0]&4097)&&re(r,"hide",!g[12]||g[12]&&!g[0]);let I=u;u=R(g),u===I?y[u].p(g,h):(me(),M(y[I],1,1,()=>{y[I]=null}),fe(),m=y[u],m?m.p(g,h):(m=y[u]=w[u](g),m.c()),E(m,1),m.m(e,null))},i(g){_||(E(t.$$.fragment,g),E(m),_=!0)},o(g){M(t.$$.fragment,g),M(m),_=!1},d(g){g&&N(e),x(t),l[26](null),y[u].d()}}}function Ge(l,e){const t=n=>{l&&!l.contains(n.target)&&!n.defaultPrevented&&e(n)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Nn(l,e,t){let n,i=[],o=null,r=null,c="closed";const s=d=>{d==="closed"?(t(9,r=null),t(10,c="closed"),t(0,F=null)):d==="waiting"?t(10,c="waiting"):t(10,c="open")},u=d=>{p&&t(9,r=d)};let m,{streaming:_=!1}=e,{pending:w=!1}=e,{root:y=""}=e,{stream_every:R=1}=e,{mode:g="image"}=e,{mirror_webcam:h}=e,{include_audio:b}=e,{webcam_constraints:I=null}=e,{i18n:P}=e,{upload:A}=e,{value:F=null}=e;const S=zn();Dn(()=>{m=document.createElement("canvas"),_&&g==="image"&&window.setInterval(()=>{n&&!w&&f()},R*1e3)});const H=async d=>{const J=d.target.value;await Qe(b,n,I,J).then(async ce=>{j=ce,t(8,o=i.find(ue=>ue.deviceId===J)||null),t(13,ne=!1)})};async function z(){try{Qe(b,n,I).then(async d=>{t(12,ae=!0),t(7,i=await _n()),j=d}).then(()=>mn(i)).then(d=>{t(7,i=d);const W=j.getTracks().map(J=>J.getSettings()?.deviceId)[0];t(8,o=W&&d.find(J=>J.deviceId===W)||i[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&S("error",P("image.no_webcam_support"))}catch(d){if(d instanceof DOMException&&d.name=="NotAllowedError")S("error",P("image.allow_webcam_access"));else throw d}}function f(){var d=m.getContext("2d");if((!_||_&&p)&&n.videoWidth&&n.videoHeight){if(m.width=n.videoWidth,m.height=n.videoHeight,d.drawImage(n,0,0,n.videoWidth,n.videoHeight),h&&(d.scale(-1,1),d.drawImage(n,-n.videoWidth,0)),_&&(!p||c==="waiting"))return;if(_){const W=m.toDataURL("image/jpeg");S("stream",W);return}m.toBlob(W=>{S(_?"stream":"capture",W)},`image/${_?"jpeg":"png"}`,.8)}}let p=!1,G=[],j,v,$;function Se(){if(p){$.stop();let d=new Blob(G,{type:v}),W=new FileReader;W.onload=async function(J){if(J.target){let ce=new File([d],"sample."+v.substring(6));const ue=await St([ce]);let Re=(await A(ue,y))?.filter(Boolean)[0];S("capture",Re),S("stop_recording")}},W.readAsDataURL(d)}else if(typeof MediaRecorder<"u"){S("start_recording"),G=[];let d=["video/webm","video/mp4"];for(let W of d)if(MediaRecorder.isTypeSupported(W)){v=W;break}if(v===null){console.error("No supported MediaRecorder mimeType");return}$=new MediaRecorder(j,{mimeType:v}),$.addEventListener("dataavailable",function(W){G.push(W.data)}),$.start(200)}t(11,p=!p)}let ae=!1;function te({destroy:d}={}){g==="image"&&_&&t(11,p=!p),d||(g==="image"?f():Se()),!p&&j&&(S("close_stream"),j.getTracks().forEach(W=>W.stop()),t(6,n.srcObject=null,n),t(12,ae=!1),window.setTimeout(()=>{t(0,F=null)},500),t(0,F=null))}let ne=!1;function qe(d){d.preventDefault(),d.stopPropagation(),t(13,ne=!1)}Cn(()=>{typeof window>"u"||(te({destroy:!0}),j?.getTracks().forEach(d=>d.stop()))});function Ee(d){hn[d?"unshift":"push"](()=>{n=d,t(6,n)})}const We=async()=>z(),Be=()=>te(),Me=()=>t(13,ne=!0),Te=()=>t(13,ne=!1);return l.$$set=d=>{"streaming"in d&&t(1,_=d.streaming),"pending"in d&&t(20,w=d.pending),"root"in d&&t(21,y=d.root),"stream_every"in d&&t(22,R=d.stream_every),"mode"in d&&t(2,g=d.mode),"mirror_webcam"in d&&t(3,h=d.mirror_webcam),"include_audio"in d&&t(23,b=d.include_audio),"webcam_constraints"in d&&t(24,I=d.webcam_constraints),"i18n"in d&&t(4,P=d.i18n),"upload"in d&&t(25,A=d.upload),"value"in d&&t(0,F=d.value)},[F,_,g,h,P,Ge,n,i,o,r,c,p,ae,ne,H,z,te,qe,s,u,w,y,R,b,I,A,Ee,We,Be,Me,Te]}class Un extends dn{constructor(e){super(),vn(this,e,Nn,jn,yn,{modify_stream:18,set_time_limit:19,streaming:1,pending:20,root:21,stream_every:22,mode:2,mirror_webcam:3,include_audio:23,webcam_constraints:24,i18n:4,upload:25,value:0,click_outside:5},null,[-1,-1])}get modify_stream(){return this.$$.ctx[18]}get set_time_limit(){return this.$$.ctx[19]}get streaming(){return this.$$.ctx[1]}set streaming(e){this.$$set({streaming:e}),V()}get pending(){return this.$$.ctx[20]}set pending(e){this.$$set({pending:e}),V()}get root(){return this.$$.ctx[21]}set root(e){this.$$set({root:e}),V()}get stream_every(){return this.$$.ctx[22]}set stream_every(e){this.$$set({stream_every:e}),V()}get mode(){return this.$$.ctx[2]}set mode(e){this.$$set({mode:e}),V()}get mirror_webcam(){return this.$$.ctx[3]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),V()}get include_audio(){return this.$$.ctx[23]}set include_audio(e){this.$$set({include_audio:e}),V()}get webcam_constraints(){return this.$$.ctx[24]}set webcam_constraints(e){this.$$set({webcam_constraints:e}),V()}get i18n(){return this.$$.ctx[4]}set i18n(e){this.$$set({i18n:e}),V()}get upload(){return this.$$.ctx[25]}set upload(e){this.$$set({upload:e}),V()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),V()}get click_outside(){return Ge}}const Ln=Un,{SvelteComponent:Pn,add_flush_callback:de,append:ke,attr:ze,bind:ge,binding_callbacks:le,bubble:ye,check_outros:pe,create_component:Q,create_slot:Fn,destroy_component:X,detach:oe,element:Ae,empty:ct,flush:q,get_all_dirty_from_scope:An,get_slot_changes:Hn,group_outros:he,init:On,insert:se,listen:He,mount_component:Y,run_all:Vn,safe_not_equal:Gn,set_style:nt,space:_e,toggle_class:De,transition_in:C,transition_out:B,update_slot_base:Jn}=window.__gradio__svelte__internal,{createEventDispatcher:Kn,tick:Ie}=window.__gradio__svelte__internal;function it(l){let e,t,n,i=l[18]&&lt(l);return t=new gt({props:{Icon:pt,label:"Remove Image"}}),t.$on("click",l[32]),{c(){i&&i.c(),e=_e(),Q(t.$$.fragment)},m(o,r){i&&i.m(o,r),se(o,e,r),Y(t,o,r),n=!0},p(o,r){o[18]?i?(i.p(o,r),r[0]&262144&&C(i,1)):(i=lt(o),i.c(),C(i,1),i.m(e.parentNode,e)):i&&(he(),B(i,1,1,()=>{i=null}),pe())},i(o){n||(C(i),C(t.$$.fragment,o),n=!0)},o(o){B(i),B(t.$$.fragment,o),n=!1},d(o){o&&oe(e),i&&i.d(o),X(t,o)}}}function lt(l){let e,t;return e=new bt({props:{container:l[21]}}),{c(){Q(e.$$.fragment)},m(n,i){Y(e,n,i),t=!0},p(n,i){const o={};i[0]&2097152&&(o.container=n[21]),e.$set(o)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Qn(l){let e,t,n=l[3]?.url&&!l[19]&&it(l);return{c(){n&&n.c(),e=ct()},m(i,o){n&&n.m(i,o),se(i,e,o),t=!0},p(i,o){i[3]?.url&&!i[19]?n?(n.p(i,o),o[0]&524296&&C(n,1)):(n=it(i),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(he(),B(n,1,1,()=>{n=null}),pe())},i(i){t||(C(n),t=!0)},o(i){B(n),t=!1},d(i){i&&oe(e),n&&n.d(i)}}}function rt(l){let e;const t=l[31].default,n=Fn(t,l,l[47],null);return{c(){n&&n.c()},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o[1]&65536)&&Jn(n,t,i,i[47],e?Hn(t,i[47],o,null):An(i[47]),null)},i(i){e||(C(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function Xn(l){let e,t,n=l[3]===null&&rt(l);return{c(){n&&n.c(),e=ct()},m(i,o){n&&n.m(i,o),se(i,e,o),t=!0},p(i,o){i[3]===null?n?(n.p(i,o),o[0]&8&&C(n,1)):(n=rt(i),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(he(),B(n,1,1,()=>{n=null}),pe())},i(i){t||(C(n),t=!0)},o(i){B(n),t=!1},d(i){i&&oe(e),n&&n.d(i)}}}function Yn(l){let e,t,n,i,o;return t=new Et({props:{src:l[3].url,alt:l[3].alt_text}}),{c(){e=Ae("div"),Q(t.$$.fragment),ze(e,"class","image-frame svelte-1hdlew6"),De(e,"selectable",l[11])},m(r,c){se(r,e,c),Y(t,e,null),n=!0,i||(o=He(e,"click",l[26]),i=!0)},p(r,c){const s={};c[0]&8&&(s.src=r[3].url),c[0]&8&&(s.alt=r[3].alt_text),t.$set(s),(!n||c[0]&2048)&&De(e,"selectable",r[11])},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){B(t.$$.fragment,r),n=!1},d(r){r&&oe(e),X(t),i=!1,o()}}}function Zn(l){let e,t,n,i;function o(s){l[37](s)}function r(s){l[38](s)}let c={root:l[12],value:l[3],mirror_webcam:l[10].mirror,stream_every:l[17],streaming:l[9],mode:"image",include_audio:!1,i18n:l[13],upload:l[15],webcam_constraints:l[10].constraints};return l[4]!==void 0&&(c.modify_stream=l[4]),l[5]!==void 0&&(c.set_time_limit=l[5]),e=new Ln({props:c}),le.push(()=>ge(e,"modify_stream",o)),le.push(()=>ge(e,"set_time_limit",r)),e.$on("capture",l[39]),e.$on("stream",l[40]),e.$on("error",l[41]),e.$on("drag",l[42]),e.$on("upload",l[43]),e.$on("close_stream",l[44]),{c(){Q(e.$$.fragment)},m(s,u){Y(e,s,u),i=!0},p(s,u){const m={};u[0]&4096&&(m.root=s[12]),u[0]&8&&(m.value=s[3]),u[0]&1024&&(m.mirror_webcam=s[10].mirror),u[0]&131072&&(m.stream_every=s[17]),u[0]&512&&(m.streaming=s[9]),u[0]&8192&&(m.i18n=s[13]),u[0]&32768&&(m.upload=s[15]),u[0]&1024&&(m.webcam_constraints=s[10].constraints),!t&&u[0]&16&&(t=!0,m.modify_stream=s[4],de(()=>t=!1)),!n&&u[0]&32&&(n=!0,m.set_time_limit=s[5],de(()=>n=!1)),e.$set(m)},i(s){i||(C(e.$$.fragment,s),i=!0)},o(s){B(e.$$.fragment,s),i=!1},d(s){X(e,s)}}}function ot(l){let e,t,n;function i(r){l[45](r)}let o={sources:l[8],handle_clear:l[23],handle_select:l[27]};return l[1]!==void 0&&(o.active_source=l[1]),e=new kt({props:o}),le.push(()=>ge(e,"active_source",i)),{c(){Q(e.$$.fragment)},m(r,c){Y(e,r,c),n=!0},p(r,c){const s={};c[0]&256&&(s.sources=r[8]),!t&&c[0]&2&&(t=!0,s.active_source=r[1],de(()=>t=!1)),e.$set(s)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){B(e.$$.fragment,r),n=!1},d(r){X(e,r)}}}function xn(l){let e,t,n,i,o,r,c,s,u,m,_,w,y,R=l[8].length>1||l[8].includes("clipboard"),g,h,b;e=new dt({props:{show_label:l[7],Icon:ht,label:l[6]||"Image"}}),i=new yt({props:{$$slots:{default:[Qn]},$$scope:{ctx:l}}});function I(f){l[34](f)}function P(f){l[35](f)}let A={hidden:l[3]!==null||l[1]==="webcam",filetype:l[1]==="clipboard"?"clipboard":"image/*",root:l[12],max_file_size:l[14],disable_click:!l[8].includes("upload")||l[3]!==null,upload:l[15],stream_handler:l[16],aria_label:l[13]("image.drop_to_upload"),$$slots:{default:[Xn]},$$scope:{ctx:l}};l[0]!==void 0&&(A.uploading=l[0]),l[2]!==void 0&&(A.dragging=l[2]),c=new qt({props:A}),l[33](c),le.push(()=>ge(c,"uploading",I)),le.push(()=>ge(c,"dragging",P)),c.$on("load",l[22]),c.$on("error",l[36]);const F=[Zn,Yn],S=[];function H(f,p){return f[1]==="webcam"&&(f[9]||!f[9]&&!f[3])?0:f[3]!==null&&!f[9]?1:-1}~(_=H(l))&&(w=S[_]=F[_](l));let z=R&&ot(l);return{c(){Q(e.$$.fragment),t=_e(),n=Ae("div"),Q(i.$$.fragment),o=_e(),r=Ae("div"),Q(c.$$.fragment),m=_e(),w&&w.c(),y=_e(),z&&z.c(),ze(r,"class","upload-container svelte-1hdlew6"),De(r,"reduced-height",l[8].length>1),nt(r,"width",l[3]?"auto":"100%"),ze(n,"data-testid","image"),ze(n,"class","image-container svelte-1hdlew6")},m(f,p){Y(e,f,p),se(f,t,p),se(f,n,p),Y(i,n,null),ke(n,o),ke(n,r),Y(c,r,null),ke(r,m),~_&&S[_].m(r,null),ke(n,y),z&&z.m(n,null),l[46](n),g=!0,h||(b=[He(r,"dragover",l[28]),He(r,"drop",l[29])],h=!0)},p(f,p){const G={};p[0]&128&&(G.show_label=f[7]),p[0]&64&&(G.label=f[6]||"Image"),e.$set(G);const j={};p[0]&2883592|p[1]&65536&&(j.$$scope={dirty:p,ctx:f}),i.$set(j);const v={};p[0]&10&&(v.hidden=f[3]!==null||f[1]==="webcam"),p[0]&2&&(v.filetype=f[1]==="clipboard"?"clipboard":"image/*"),p[0]&4096&&(v.root=f[12]),p[0]&16384&&(v.max_file_size=f[14]),p[0]&264&&(v.disable_click=!f[8].includes("upload")||f[3]!==null),p[0]&32768&&(v.upload=f[15]),p[0]&65536&&(v.stream_handler=f[16]),p[0]&8192&&(v.aria_label=f[13]("image.drop_to_upload")),p[0]&8|p[1]&65536&&(v.$$scope={dirty:p,ctx:f}),!s&&p[0]&1&&(s=!0,v.uploading=f[0],de(()=>s=!1)),!u&&p[0]&4&&(u=!0,v.dragging=f[2],de(()=>u=!1)),c.$set(v);let $=_;_=H(f),_===$?~_&&S[_].p(f,p):(w&&(he(),B(S[$],1,1,()=>{S[$]=null}),pe()),~_?(w=S[_],w?w.p(f,p):(w=S[_]=F[_](f),w.c()),C(w,1),w.m(r,null)):w=null),(!g||p[0]&256)&&De(r,"reduced-height",f[8].length>1),p[0]&8&&nt(r,"width",f[3]?"auto":"100%"),p[0]&256&&(R=f[8].length>1||f[8].includes("clipboard")),R?z?(z.p(f,p),p[0]&256&&C(z,1)):(z=ot(f),z.c(),C(z,1),z.m(n,null)):z&&(he(),B(z,1,1,()=>{z=null}),pe())},i(f){g||(C(e.$$.fragment,f),C(i.$$.fragment,f),C(c.$$.fragment,f),C(w),C(z),g=!0)},o(f){B(e.$$.fragment,f),B(i.$$.fragment,f),B(c.$$.fragment,f),B(w),B(z),g=!1},d(f){f&&(oe(t),oe(n)),X(e,f),X(i),l[33](null),X(c),~_&&S[_].d(),z&&z.d(),l[46](null),h=!1,Vn(b)}}}function ei(l,e,t){let n,{$$slots:i={},$$scope:o}=e,{value:r=null}=e,{label:c=void 0}=e,{show_label:s}=e,{sources:u=["upload","clipboard","webcam"]}=e,{streaming:m=!1}=e,{pending:_=!1}=e,{webcam_options:w}=e,{selectable:y=!1}=e,{root:R}=e,{i18n:g}=e,{max_file_size:h=null}=e,{upload:b}=e,{stream_handler:I}=e,{stream_every:P}=e,{modify_stream:A}=e,{set_time_limit:F}=e,{show_fullscreen_button:S=!0}=e,H,{uploading:z=!1}=e,{active_source:f=null}=e;async function p({detail:a}){if(!m){if(a.path?.toLowerCase().endsWith(".svg")&&a.url){const $e=await(await fetch(a.url)).text();t(3,r={...a,url:`data:image/svg+xml,${encodeURIComponent($e)}`})}else t(3,r=a);await Ie(),v("upload")}}function G(){t(3,r=null),v("clear"),v("change",null)}async function j(a,ie){if(ie==="stream"){v("stream",{value:{url:a},is_value_data:!0});return}t(30,_=!0);const $e=await H.load_files([new File([a],`image/${m?"jpeg":"png"}`)]);(ie==="change"||ie==="upload")&&(t(3,r=$e?.[0]||null),await Ie(),v("change")),t(30,_=!1)}const v=Kn();let{dragging:$=!1}=e;function Se(a){let ie=It(a);ie&&v("select",{index:ie,value:null})}async function ae(a){switch(a){case"clipboard":H.paste_clipboard();break}}let te;function ne(a){a.preventDefault(),a.stopPropagation(),a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),t(2,$=!0)}async function qe(a){a.preventDefault(),a.stopPropagation(),t(2,$=!1),r&&(G(),await Ie()),t(1,f="upload"),await Ie(),H.load_files_from_drop(a)}const Ee=a=>{t(3,r=null),v("clear"),a.stopPropagation()};function We(a){le[a?"unshift":"push"](()=>{H=a,t(20,H)})}function Be(a){z=a,t(0,z)}function Me(a){$=a,t(2,$)}function Te(a){ye.call(this,l,a)}function d(a){A=a,t(4,A)}function W(a){F=a,t(5,F)}const J=a=>j(a.detail,"change"),ce=a=>j(a.detail,"stream");function ue(a){ye.call(this,l,a)}function Re(a){ye.call(this,l,a)}const ut=a=>j(a.detail,"upload");function _t(a){ye.call(this,l,a)}function ft(a){f=a,t(1,f),t(8,u)}function mt(a){le[a?"unshift":"push"](()=>{te=a,t(21,te)})}return l.$$set=a=>{"value"in a&&t(3,r=a.value),"label"in a&&t(6,c=a.label),"show_label"in a&&t(7,s=a.show_label),"sources"in a&&t(8,u=a.sources),"streaming"in a&&t(9,m=a.streaming),"pending"in a&&t(30,_=a.pending),"webcam_options"in a&&t(10,w=a.webcam_options),"selectable"in a&&t(11,y=a.selectable),"root"in a&&t(12,R=a.root),"i18n"in a&&t(13,g=a.i18n),"max_file_size"in a&&t(14,h=a.max_file_size),"upload"in a&&t(15,b=a.upload),"stream_handler"in a&&t(16,I=a.stream_handler),"stream_every"in a&&t(17,P=a.stream_every),"modify_stream"in a&&t(4,A=a.modify_stream),"set_time_limit"in a&&t(5,F=a.set_time_limit),"show_fullscreen_button"in a&&t(18,S=a.show_fullscreen_button),"uploading"in a&&t(0,z=a.uploading),"active_source"in a&&t(1,f=a.active_source),"dragging"in a&&t(2,$=a.dragging),"$$scope"in a&&t(47,o=a.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&258&&!f&&u&&t(1,f=u[0]),l.$$.dirty[0]&514&&t(19,n=m&&f==="webcam"),l.$$.dirty[0]&524289&&z&&!n&&t(3,r=null),l.$$.dirty[0]&4&&v("drag",$)},[z,f,$,r,A,F,c,s,u,m,w,y,R,g,h,b,I,P,S,n,H,te,p,G,j,v,Se,ae,ne,qe,_,i,Ee,We,Be,Me,Te,d,W,J,ce,ue,Re,ut,_t,ft,mt,o]}class ti extends Pn{constructor(e){super(),On(this,e,ei,xn,Gn,{value:3,label:6,show_label:7,sources:8,streaming:9,pending:30,webcam_options:10,selectable:11,root:12,i18n:13,max_file_size:14,upload:15,stream_handler:16,stream_every:17,modify_stream:4,set_time_limit:5,show_fullscreen_button:18,uploading:0,active_source:1,dragging:2},null,[-1,-1])}get value(){return this.$$.ctx[3]}set value(e){this.$$set({value:e}),q()}get label(){return this.$$.ctx[6]}set label(e){this.$$set({label:e}),q()}get show_label(){return this.$$.ctx[7]}set show_label(e){this.$$set({show_label:e}),q()}get sources(){return this.$$.ctx[8]}set sources(e){this.$$set({sources:e}),q()}get streaming(){return this.$$.ctx[9]}set streaming(e){this.$$set({streaming:e}),q()}get pending(){return this.$$.ctx[30]}set pending(e){this.$$set({pending:e}),q()}get webcam_options(){return this.$$.ctx[10]}set webcam_options(e){this.$$set({webcam_options:e}),q()}get selectable(){return this.$$.ctx[11]}set selectable(e){this.$$set({selectable:e}),q()}get root(){return this.$$.ctx[12]}set root(e){this.$$set({root:e}),q()}get i18n(){return this.$$.ctx[13]}set i18n(e){this.$$set({i18n:e}),q()}get max_file_size(){return this.$$.ctx[14]}set max_file_size(e){this.$$set({max_file_size:e}),q()}get upload(){return this.$$.ctx[15]}set upload(e){this.$$set({upload:e}),q()}get stream_handler(){return this.$$.ctx[16]}set stream_handler(e){this.$$set({stream_handler:e}),q()}get stream_every(){return this.$$.ctx[17]}set stream_every(e){this.$$set({stream_every:e}),q()}get modify_stream(){return this.$$.ctx[4]}set modify_stream(e){this.$$set({modify_stream:e}),q()}get set_time_limit(){return this.$$.ctx[5]}set set_time_limit(e){this.$$set({set_time_limit:e}),q()}get show_fullscreen_button(){return this.$$.ctx[18]}set show_fullscreen_button(e){this.$$set({show_fullscreen_button:e}),q()}get uploading(){return this.$$.ctx[0]}set uploading(e){this.$$set({uploading:e}),q()}get active_source(){return this.$$.ctx[1]}set active_source(e){this.$$set({active_source:e}),q()}get dragging(){return this.$$.ctx[2]}set dragging(e){this.$$set({dragging:e}),q()}}const vi=ti;export{Ot as C,vi as I,Ln as W};
//# sourceMappingURL=ImageUploader-WLPQkcMx.js.map
